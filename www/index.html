<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <link rel="stylesheet" href="/css/basic.css" type="text/css">
        <title>Index</title>
    </head>
    <body>
        <nav class="navbar">
            <a href="/">首頁</a>
            <a href="/login.html">登錄/註冊</a>
        </nav>
        <div class="container">
            <div id="course">
                <img f-name="Image" f-onclick="Id" class="thumbnail"/>
                <header f-name="Title" f-onclick="Id" style="font-weight: bold; font-size: large"></header>
                <time f-name="Time" style="color: #444; font-size: small"></time>
            </div>
        </div>
        <button id="more" style="width: 100%">更多</button>
    </body>
</html>
<script src="/js/functions.js" charset="utf-8"></script>
<script charset="utf-8">
// type CourseSummary struct {
//     Id int
//     Time int64
//     Title string
//     Introduction string
//     Image string
//     Level int
// }

var nodes = select_template('#course');

async function load_more(page, size) {
    var data = await load_courses(page, size);
    extend_items(data.Courses, nodes.tpl, nodes.ptr, function(id) {
        location.href = `/course.html?id=${id}`;
    });
    var more = document.querySelector('#more');
    if (data.Page >= data.Total - 1) {
        more.parentNode.removeChild(more);
    } else {
        more.onclick = function() {
            load_more(page + 1, size);
        }
    }
}

window.onload = function() {
    load_more(0, 4);
};
</script>
